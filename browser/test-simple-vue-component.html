<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TipTap Vue组件示例</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    
    .editor-container {
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      margin: 20px 0;
    }
    
    .toolbar {
      display: flex;
      gap: 10px;
      padding: 10px;
      background: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .toolbar button {
      padding: 8px 16px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }
    
    .toolbar button:hover {
      background: #f3f4f6;
    }
    
    .ProseMirror {
      padding: 1rem;
      min-height: 200px;
      outline: none;
    }
    
    .output-container {
      margin-top: 20px;
    }
    
    .output-container h2 {
      color: #333;
      margin-bottom: 10px;
    }
    
    .output {
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script type="module">
    import { createApp, h } from 'vue'
    import { Editor } from '@tiptap/core'
    import { EditorContent } from '@tiptap/vue-3'
    import { StarterKit } from '@tiptap/starter-kit'
    import VueTextBtnDemo from './packages/tiptap-ext-vue-text-btn-demo/src/index.ts'

    // 创建编辑器实例
    const editor = new Editor({
      extensions: [
        StarterKit,
        VueTextBtnDemo,
      ],
      content: '<p>Click the button below: </p>',
    })

    // 插入Vue组件的函数
    function insertVueComponent() {
      editor.commands.insertVueTextBtnDemo()
    }

    // 创建Vue应用
    const app = createApp({
      data() {
        return {
          htmlOutput: '',
          jsonOutput: ''
        }
      },
      mounted() {
        // 初始化输出
        this.updateOutputs()
        
        // 监听编辑器变化
        editor.on('update', () => {
          this.updateOutputs()
        })
      },
      methods: {
        updateOutputs() {
          this.htmlOutput = editor.getHTML()
          this.jsonOutput = JSON.stringify(editor.getJSON(), null, 2)
        }
      },
      render() {
        return h('div', [
          h('h1', 'TipTap Vue组件示例'),
          h('div', { class: 'editor-container' }, [
            h('div', { class: 'toolbar' }, [
              h('button', {
                onClick: insertVueComponent,
              }, '插入Vue组件')
            ]),
            h(EditorContent, { editor })
          ]),
          h('div', { class: 'output-container' }, [
            h('h2', 'HTML输出'),
            h('pre', { class: 'output' }, this.htmlOutput),
            h('h2', 'JSON输出'),
            h('pre', { class: 'output' }, this.jsonOutput)
          ])
        ])
      }
    })

    app.mount('#app')
  </script>
</body>
</html>